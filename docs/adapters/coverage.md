# Coverage Adapters

Coverage adapters parse test coverage reports and provide file-level and function-level metrics to nit's analysis pipeline.

## Supported tools

| Adapter | Language | Report format |
|---------|----------|---------------|
| coverage.py | Python | JSON, XML |
| Istanbul | JavaScript/TypeScript | JSON |
| go cover | Go | Text profile |
| Coverlet | C#/.NET | JSON, Cobertura XML |
| JaCoCo | Java, Kotlin | XML |
| gcov | C/C++ | gcov output |
| tarpaulin | Rust | JSON |

## What coverage adapters provide

Each adapter parses framework-specific coverage reports and normalizes them into a common format:

- **File coverage** — line, branch, and function coverage percentages per file
- **Function-level data** — coverage metrics for individual functions
- **Gap identification** — files and functions below configured thresholds
- **Dead zones** — high-complexity code with zero coverage

## Configuration

Coverage thresholds are configured in `.nit.yml`:

```yaml
coverage:
  line_threshold: 80.0         # Minimum line coverage %
  branch_threshold: 75.0       # Minimum branch coverage %
  function_threshold: 85.0     # Minimum function coverage %
  complexity_threshold: 10     # Cyclomatic complexity threshold
  undertested_threshold: 50.0  # "Undertested" cutoff %
```

## coverage.py (Python)

Parses JSON or XML reports from Python's `coverage.py` tool.

```bash
# Generate a JSON report
coverage run -m pytest
coverage json -o coverage.json
```

nit looks for `coverage.json`, `coverage.xml`, or `.coverage` files in the project root.

## Istanbul (JavaScript/TypeScript)

Parses Istanbul/NYC JSON coverage reports.

```bash
# Vitest with coverage
npx vitest run --coverage
```

nit looks for `coverage/coverage-final.json` or `coverage/coverage-summary.json`.

## go cover (Go)

Parses Go's text-format coverage profiles.

```bash
go test -coverprofile=coverage.out ./...
```

nit looks for `coverage.out` or `cover.out`.

## Coverlet (C#/.NET)

Parses Coverlet's JSON or Cobertura XML reports.

```bash
dotnet test --collect:"XPlat Code Coverage"
```

## JaCoCo (Java/Kotlin)

Parses JaCoCo XML reports, commonly generated by Maven or Gradle.

```bash
# Maven
mvn test jacoco:report

# Gradle
./gradlew test jacocoTestReport
```

## gcov (C/C++)

Parses gcov output for GCC/Clang-compiled projects.

```bash
gcc --coverage -o myapp myapp.c
./myapp
gcov myapp.c
```

## tarpaulin (Rust)

Parses `cargo tarpaulin` JSON output.

```bash
cargo tarpaulin --out Json
```

## How nit uses coverage data

The [Coverage Analyzer](../agents/analyzers.md#coverage-analyzer) consumes coverage adapter output to:

1. Identify **untested files** — files with no coverage data at all
2. Identify **undertested functions** — functions below the `undertested_threshold`
3. Identify **dead zones** — high-complexity functions with zero coverage (highest priority)
4. Prioritize test generation targets based on risk and coverage gaps
